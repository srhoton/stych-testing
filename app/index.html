<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stytch B2B OAuth Authentication</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Stytch SDK from jsDelivr CDN -->
    <script type="module">
        // Import B2B client from the correct path as per documentation
        import { StytchB2BUIClient } from 'https://cdn.jsdelivr.net/npm/@stytch/vanilla-js@latest/b2b/+esm';
        
        // Make it globally available
        window.StytchB2BUIClient = StytchB2BUIClient;
        console.log('StytchB2BUIClient imported:', typeof StytchB2BUIClient);
        console.log('StytchB2BUIClient available:', StytchB2BUIClient);
    </script>
</head>
<body>
    <div class="container">
        <div class="auth-card">
            <h1>Stytch B2B OAuth Demo</h1>
            
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <p>Checking authentication...</p>
            </div>
            
            <div id="authenticated" class="auth-status hidden">
                <div class="success-icon">‚úì</div>
                <h2>You are authenticated!</h2>
                <div id="user-info" class="user-info"></div>
                <button id="logout-btn" class="btn btn-secondary">Logout</button>
            </div>
            
            <div id="unauthenticated" class="auth-status hidden">
                <div class="lock-icon">üîí</div>
                <h2>Please sign in</h2>
                <p>Choose your preferred sign-in method</p>
                <div class="info-message">
                    <p>‚ÑπÔ∏è <strong>Note:</strong> This organization requires an invitation. Only registered members can sign in.</p>
                </div>
                
                <!-- OAuth Sign In -->
                <button id="login-btn" class="btn btn-primary">
                    <span class="google-icon">
                        <svg width="18" height="18" viewBox="0 0 48 48">
                            <path fill="#4285F4" d="M24 9.5c3.2 0 5.9 1.1 8.1 2.9l6-6C34.1 2.7 29.5 0 24 0 14.6 0 6.7 5.5 3.2 13.5l7.5 5.8C12.2 13.1 17.6 9.5 24 9.5z"/>
                            <path fill="#34A853" d="M46.5 24.5c0-1.6-.1-3.1-.4-4.5H24v9h12.7c-.6 3-2.3 5.5-4.8 7.1l7.5 5.8c4.4-4 7.1-10 7.1-17.4z"/>
                            <path fill="#FBBC05" d="M10.7 28.7c-.6-1.7-.9-3.6-.9-5.5s.3-3.8.9-5.5L3.2 11.9C1.2 15.9 0 20.3 0 25s1.2 9.1 3.2 13.1l7.5-5.8z"/>
                            <path fill="#EA4335" d="M24 48c5.5 0 10.1-1.8 13.5-4.9l-7.5-5.8c-2 1.4-4.6 2.2-6 2.2-6.4 0-11.8-4.3-13.7-10.1l-7.5 5.8C6.7 42.5 14.6 48 24 48z"/>
                        </svg>
                    </span>
                    Sign in with Google
                </button>
                
                <!-- Divider -->
                <div class="divider">
                    <span>OR</span>
                </div>
                
                <!-- Email Magic Link -->
                <div class="email-form">
                    <input 
                        type="email" 
                        id="email-input" 
                        class="email-input" 
                        placeholder="Enter your email address"
                        autocomplete="email"
                    />
                    <button id="magic-link-btn" class="btn btn-secondary">
                        <span>üìß</span>
                        Send Magic Link
                    </button>
                </div>
                
                <!-- Success message for magic link sent -->
                <div id="magic-link-success" class="success-message hidden">
                    <p>‚úÖ Magic link sent! Check your email to sign in.</p>
                </div>
                
                <!-- Another Divider -->
                <div class="divider">
                    <span>OR</span>
                </div>
                
                <!-- Password Login -->
                <div class="password-form">
                    <input 
                        type="email" 
                        id="password-email-input" 
                        class="email-input" 
                        placeholder="Email address"
                        autocomplete="email"
                    />
                    <input 
                        type="password" 
                        id="password-input" 
                        class="password-input" 
                        placeholder="Password"
                        autocomplete="current-password"
                    />
                    <button id="password-login-btn" class="btn btn-secondary">
                        <span>üîë</span>
                        Sign in with Password
                    </button>
                    <div class="password-options">
                        <a href="#" id="forgot-password-link" class="forgot-password">Forgot password?</a>
                    </div>
                </div>
                
                <!-- Password Reset Form (hidden by default) -->
                <div id="password-reset-form" class="password-reset-form hidden">
                    <h3>Reset Password</h3>
                    <input 
                        type="email" 
                        id="reset-email-input" 
                        class="email-input" 
                        placeholder="Enter your email address"
                        autocomplete="email"
                    />
                    <button id="send-reset-btn" class="btn btn-secondary">
                        Send Reset Email
                    </button>
                    <a href="#" id="back-to-login" class="back-link">‚Üê Back to login</a>
                </div>
                
                <!-- Password Reset Success -->
                <div id="password-reset-success" class="success-message hidden">
                    <p>‚úÖ Password reset email sent! Check your inbox.</p>
                </div>
                
                <!-- New Password Form (for reset flow) -->
                <div id="new-password-form" class="new-password-form hidden">
                    <h3>Set New Password</h3>
                    <input 
                        type="password" 
                        id="new-password-input" 
                        class="password-input" 
                        placeholder="Enter new password"
                        autocomplete="new-password"
                    />
                    <input 
                        type="password" 
                        id="confirm-password-input" 
                        class="password-input" 
                        placeholder="Confirm new password"
                        autocomplete="new-password"
                    />
                    <button id="set-password-btn" class="btn btn-primary">
                        Set New Password
                    </button>
                </div>
            </div>
            
            <div id="error" class="error-message hidden">
                <p id="error-text"></p>
            </div>
        </div>
    </div>
    
    <script src="config.js"></script>
    <script src="auth.js"></script>
</body>
</html>